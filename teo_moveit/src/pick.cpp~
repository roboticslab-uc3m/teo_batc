/* Code for a move_group subtask part of the project "New task generation using old cases and a description of the task"
 *
 * Author: Raúl Fernández Fernández
 *
 * This node creates a service with the objective to pick the "object" given by the msg with the group action especifed, send to this node. At the current
 * state there is not grasp action, only a simple attaching by code.
 *
 */

#include <ros/ros.h>
#include <moveit/move_group_interface/move_group.h>
#include <moveit/planning_scene_monitor/planning_scene_monitor.h>
#include "teo_moveit/pick_srv.h"
//#include "move_group_controller.h"


bool pick_action(teo_moveit::pick_srv::Request &req, teo_moveit::pick_srv::Response &res)
{
  //We specify the moveit group we want to work with
  moveit::planning_interface::MoveGroup group(req.group_name);

  group.attachObject(req.pick_object.id);
  ROS_INFO("End of attaching");

  return true;
}

int main(int argc, char **argv)
{
  //Node init
  ros::init(argc, argv, "pick_srv");
  ros::NodeHandle nh;

  ros::ServiceServer service = nh.advertiseService("pick_srv", pick_action);
  ROS_INFO("Ready to pick");
  ros::spin();

  return 0;
}
